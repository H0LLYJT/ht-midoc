[{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"about-midoc","dir":"Articles","previous_headings":"","what":"About midoc","title":"Multiple Imputation DOCtor (midoc)","text":"Missing data common issue health social research, often addressed multiple imputation (MI). MI flexible general approach, suite software packages. However, using MI practice can complex. Application MI involves multiple decisions rarely justified even documented, little guidance available. Multiple Imputation DOCtor (midoc) R package decision-making system incorporates expert, --date guidance help choose appropriate analysis method missing data. midoc guide analysis, examining hypothesised causal relationships observed data advise whether MI needed, perform . assume interested obtaining unbiased estimates regression coefficients - note bias necessarily concern interest prediction (.e. diagnostic/prognostic modelling). , demonstrate key features midoc using worked example. example, wish estimate association maternal age first pregnancy (exposure) child’s body mass index (BMI) age 7 years (outcome). simplicity, consider one confounder relationship maternal age BMI age 7 years, maternal education level. Note simulated data study included midoc package bmi dataset. dataset contains 1000 observations, realistic values variable, exaggerated relationships variables (highlight consequences choice analysis approach). Note interactive version vignette: Multiple Imputation DOCtor (midoc) Shiny version also available run locally (can run using midoc command midocVignette()). interactive version, can apply features midoc described using DAG data.","code":""},{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"step-1-specify-the-analysis-and-missingness-models-using-a-directed-acyclic-graph","dir":"Articles","previous_headings":"","what":"Step 1 Specify the analysis and missingness models using a directed acyclic graph","title":"Multiple Imputation DOCtor (midoc)","text":"First, construct causal diagram, directed acyclic graph (DAG) example, using syntax per dagitty package. start specifying relationships variables, assuming missing data. assume maternal age (matage) causes BMI age 7 years (bmi7), maternal education level (mated) causes maternal age BMI age 7 years. can express relationships using “dagitty” syntax, follows: Next, partially observed variable, specify variables related probability missing (“missingness”) adding relationships DAG. type DAG often referred “missingness” DAG (mDAG) 1, 2. first use midoc function descMissData identify variables dataset partially observed, specifying outcome (y), covariates, .e. independent variables, (covs), dataset (data), follows. see two missing data patterns: either variables observed, BMI age 7 years missing covariates observed. use indicator variable “R” denote missingness BMI age 7 years (example, R=1 BMI age 7 years observed, 0 otherwise). specific example, R also indicates complete record (R=1 variables fully observed, 0 otherwise) variables fully observed. suppose R related maternal education level via socio-economic position (SEP), .e. SEP cause maternal education level R, neither BMI age 7 years maternal age causes R. suppose SEP missing (unmeasured) individuals dataset; remind us fact, name variable sep_unmeas. mDAG now follows (note follow convention using lower case names variables code, R becomes “r”, ): Note instead believe maternal education direct cause R, mDAG follows: now draw mDAG visually check relationships specified intended: Note used additional commands specify layout mDAG shown - although necessary using midoc, go dagitty website like find using “dagitty” draw mDAGs.  final check mDAG, use midoc function exploreDAG explore whether relationships dataset consistent proposed mDAG, specifying mDAG (mdag) dataset (data), follows. Based relationships fully observed variables maternal age, maternal education, missingness BMI age 7 years, can see little evidence inconsistency dataset proposed mDAG. particular, mDAG assumes maternal age (matage) unrelated missingness BMI age 7 years (r), given maternal education (mated); results suggest plausible. Note use observed data explore whether BMI age 7 years unrelated missingness - need missing values BMI age 7 years order . Tips specifying “missingness” DAG First specify DAG analysis model, missing data. may find introduction DAGs useful 3. Next add missingness indicator(s) DAG. multiple variables missing data, may want start including just complete records indicator DAG. Identify variables related missingness using: Subject-matter knowledge, example, prior research causes drop-study knowledge data collection process Data exploration, example, performing logistic regression missingness indicator analysis model variables - noting may exclude variables large proportion missing data avoid perfect prediction","code":"matage -> bmi7 mated -> matage mated -> bmi7 descMissData(y=\"bmi7\", covs=\"matage mated\", data=bmi) pattern bmi7 matage mated   n pct        1    1      1     1 592  59        2    0      1     1 408  41 matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r matage -> bmi7 mated -> matage mated -> bmi7 mated -> r exploreDAG(mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r\", data=bmi) The proposed directed acyclic graph (DAG) implies that the following  pairs of variables are independent, or conditionally independent.  'X  _||_ Y | Z' should be read as 'X is independent of Y conditional on Z'.  Note that variable names are abbreviated:   bmi7 _||_ r | sp_n bmi7 _||_ r | matd bmi7 _||_ sp_n | matd matg _||_ r | sp_n matg _||_ r | matd matg _||_ sp_n | matd matd _||_ r | sp_n  These (conditional) independence statements are explored below using  the canonical correlations approach for mixed data. See  ??dagitty::localTests for further details.    Results are shown for variables that are fully observed in the  specified dataset.  The null hypothesis is that the stated variables are (conditionally)  independent.                           estimate  p.value        2.5%      97.5% matage _||_ r | mated 0.02998323 0.343547 -0.03206946 0.09180567   Interpretation: A small p-value means the stated variables may not be  (conditionally) independent in the specified dataset: your data may not  be consistent with the proposed DAG.  A large p-value means there is  little evidence of inconsistency between your data and the proposed DAG.   Note that these results assume that relationships between variables are  linear. Consider exploring the specification of each relationship in  your model.  Also consider whether it is valid and possible to explore  relationships between partially observed variables using the observed  data, e.g. avoiding perfect prediction."},{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"step-2-check-whether-complete-records-analysis-is-likely-to-be-a-valid-strategy","dir":"Articles","previous_headings":"","what":"Step 2 Check whether complete records analysis is likely to be a valid strategy","title":"Multiple Imputation DOCtor (midoc)","text":"next step determine whether complete records analysis (CRA) valid strategy, using mDAG. Remember , general, CRA valid analysis model outcome unrelated complete records indicator, conditional analysis model covariates 4 (special cases, depending type analysis model estimand interest, rule can relaxed 5 - , consider general setting without making assumptions fitted model). Suppose decide estimate unadjusted association BMI age 7 years maternal age, without including confounder maternal education model. use midoc function checkCRA applied mDAG check whether CRA valid model, specifying outcome (y), covariates, .e. independent variables, (covs), complete records indicator (r_cra), mDAG (mdag), follows: can see CRA valid (can also tell inspecting DAG: open path bmi7 r via mated sep_unmeas condition matage). checkCRA suggests CRA valid included mated, mated sep_unmeas, analysis model. particular setting, sensible include mated analysis model since confounder relationship matage bmi7. settings, might want include variables required valid CRA model might change interpretation - case, need use different analysis strategy. Note sep_unmeas related bmi7 condition mated (though still related missingness bmi7), need included analysis model. add mated model re-run checkCRA, , see CRA now valid. Note outcome, BMI age 7 years, cause missingness, CRA always invalid, .e. variables add analysis model make CRA valid. See see results checkCRA case (note, code, added path bmi7 r specified mDAG).","code":"checkCRA(y=\"bmi7\", covs=\"matage\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are not independent given  analysis model covariates. Hence, in general, complete records analysis  is not valid.    In special cases, depending on the type of analysis model and estimand  of interest, complete records analysis may still be valid. See, for  example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  for further details.   Consider using a different analysis model and/or strategy, e.g.  multiple imputation.   For example, the analysis model outcome and complete record indicator  are independent if, in addition to the specified covariates, the  following sets of variables are included as covariates in the analysis  model (note that this list is not necessarily exhaustive, particularly  if your DAG is complex):   { mated } { mated, sep_unmeas } checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are independent given analysis  model covariates. Hence, complete records analysis is valid. checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r bmi7 -> r\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are not independent given  analysis model covariates. Hence, in general, complete records analysis  is not valid.    In special cases, depending on the type of analysis model and estimand  of interest, complete records analysis may still be valid. See, for  example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  for further details.   There are no other variables which could be added to the model to make  the analysis model outcome and complete record indicator conditionally  independent, without changing the estimand of interest.    Consider using a different strategy e.g. multiple imputation."},{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"step-3-check-whether-multiple-imputation-is-likely-to-be-a-valid-strategy","dir":"Articles","previous_headings":"","what":"Step 3 Check whether multiple imputation is likely to be a valid strategy","title":"Multiple Imputation DOCtor (midoc)","text":"Although CRA valid example, may also wish perform MI. Remember MI valid principle partially observed variable unrelated missingness, given imputation model predictors. Furthermore, include analysis model variables imputation model partially observed variable, form implied analysis model, analysis imputation models “compatible”. theory, given multiple partially observed variables, validity MI may imply different causes missingness missing data pattern. example, BMI age 7 years maternal education partially observed, MI valid missingness BMI age 7 years unrelated maternal education among individuals missing BMI age 7 years maternal education (given observed data), although missingness BMI age 7 years related maternal education among individuals observed maternal education. practice, recommend focusing common missing data patterns /variables missing data. Less common missing data patterns can often assumed missing completely random - unlikely change final conclusions assumption incorrect. example, single partially observed variable (BMI age 7 years), relatively simple check validity MI based mDAG. already verified (using checkCRA) BMI age 7 years unrelated missingness, given maternal age maternal education. Therefore, know MI valid use variables imputation model BMI age 7 years (analysis model imputation model exactly case). However, MI using just maternal age maternal education imputation model BMI age 7 years recover additional information compared CRA. Therefore, may wish include “auxiliary variables” imputation model BMI age 7 years (.e. variables predictive BMI age 7 years, required analysis model) improve precision MI estimate, compared CRA estimate. example, two variables used auxiliary variables: pregnancy size - singleton multiple birth - (pregsize) birth weight (bwt). inspect missing data patterns dataset , included auxiliary variables, using descMissData. can see auxiliary variables fully observed. assume pregnancy size cause BMI age 7 years, missingness, whereas assume birth weight related BMI 7 years (via pregnancy size) missingness (via SEP). now add variables mDAG. , shown updated mDAG.  also explore whether relationships dataset consistent updated mDAG using exploreDAG, follows. results suggest updated mDAG plausible. Note CRA still valid updated mDAG. can check using checkCRA : now use midoc function checkMI applied DAG check whether MI valid imputation model predictors BMI age 7 years include pregnancy size birth weight, well maternal age maternal education, specifying partially observed variable (dep), predictors (preds), missingness indicator partially observed variable (r_dep), mDAG (mdag). first consider imputation model including pregnancy size. results shown . suggest MI valid principle included pregnancy size well analysis model variables imputation model BMI age 7 years. next consider imputation model including birth weight. results shown . suggest MI valid included birth weight well analysis model variables imputation model BMI age 7 years (can also tell inspecting mDAG: since bwt shares common cause bmi7 r, “collider”, hence conditioning bwt opens path bmi7 r via bwt). Note theory, suggested checkMI results shown , MI valid added birth weight pregnancy size auxiliary variables imputation model (note SEP needed, conditional imputation model predictors). However, practice, strategy may still result biased estimates, due unmeasured confounding relationship BMI age 7 years birth weight. recommend including colliders partially observed variable missingness auxiliary variables 6.","code":"descMissData(y=\"bmi7\", covs=\"matage mated pregsize bwt\", data=bmi) pattern bmi7 matage mated pregsize bwt   n pct        1    1      1     1        1   1 592  59        2    0      1     1        1   1 408  41 exploreDAG(mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r             pregsize -> bmi7 pregsize -> bwt  sep_unmeas -> bwt\", data=bmi) The proposed directed acyclic graph (DAG) implies that the following  pairs of variables are independent, or conditionally independent.  'X  _||_ Y | Z' should be read as 'X is independent of Y conditional on Z'.  Note that variable names are abbreviated:   bmi7 _||_ bwt | prgs, sp_n bmi7 _||_ bwt | matd, prgs bmi7 _||_ r | sp_n bmi7 _||_ r | matd bmi7 _||_ sp_n | matd bwt _||_ matg | matd bwt _||_ matg | sp_n bwt _||_ matd | sp_n bwt _||_ r | sp_n matg _||_ prgs matg _||_ r | sp_n matg _||_ r | matd matg _||_ sp_n | matd matd _||_ prgs matd _||_ r | sp_n prgs _||_ r prgs _||_ sp_n  These (conditional) independence statements are explored below using  the canonical correlations approach for mixed data. See  ??dagitty::localTests for further details.    Results are shown for variables that are fully observed in the  specified dataset.  The null hypothesis is that the stated variables are (conditionally)  independent.                             estimate   p.value        2.5%      97.5% bwt _||_ matage | mated 0.05018898 0.1127099 -0.01184095 0.11183410 matage _||_ pregsize    0.03029139 0.3386080 -0.03176134 0.09211150 matage _||_ r | mated   0.02998323 0.3435470 -0.03206946 0.09180567 mated _||_ pregsize     0.01594976 0.6144181 -0.04608889 0.07786585 pregsize _||_ r         0.01482015 0.6397174 -0.04721631 0.07674273   Interpretation: A small p-value means the stated variables may not be  (conditionally) independent in the specified dataset: your data may not  be consistent with the proposed DAG.  A large p-value means there is  little evidence of inconsistency between your data and the proposed DAG.   Note that these results assume that relationships between variables are  linear. Consider exploring the specification of each relationship in  your model.  Also consider whether it is valid and possible to explore  relationships between partially observed variables using the observed  data, e.g. avoiding perfect prediction. checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r           pregsize -> bmi7 pregsize -> bwt  sep_unmeas -> bwt\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are independent given analysis  model covariates. Hence, complete records analysis is valid. checkMI(dep=\"bmi7\", preds=\"matage mated pregsize\", r_dep=\"r\",         mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r          pregsize -> bmi7 pregsize -> bwt  sep_unmeas -> bwt\") Based on the proposed directed acyclic graph (DAG), the incomplete  variable and its missingness indicator are independent given imputation  model predictors. Hence, multiple imputation methods which assume data  are missing at random are valid in principle. checkMI(dep=\"bmi7\", preds=\"matage mated bwt\", r_dep=\"r\",         mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r          pregsize -> bmi7 pregsize -> bwt  sep_unmeas -> bwt\") Based on the proposed directed acyclic graph (DAG), the incomplete  variable and its missingness indicator are not independent given  imputation model predictors. Hence, multiple imputation methods which  assume data are missing at random are not valid.    Consider using a different imputation model and/or strategy (e.g.  not-at-random fully conditional specification).   For example, the incomplete variable and its missingness indicator are  independent if, in addition to the specified predictors, the following  sets of variables are included as predictors in the imputation model  (note that this list is not necessarily exhaustive, particularly if  your DAG is complex):   { pregsize } { pregsize, sep_unmeas }"},{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"step-4-check-that-all-relationships-are-correctly-specified","dir":"Articles","previous_headings":"","what":"Step 4 Check that all relationships are correctly specified","title":"Multiple Imputation DOCtor (midoc)","text":"far, explored whether CRA MI valid principle using mDAG, without making assumptions form variables, relationships . However, MI give unbiased estimates, imputation models must compatible analysis model correctly specified: must contain variables required analysis model, must include relationships implied analysis model e.g. interactions, must specify form relationships correctly 7. Since CRA MI valid principle worked example, use complete records bmi dataset explore specification relationships BMI age 7 years predictors (analysis model variables, maternal age maternal education, plus auxiliary variable, pregnancy size) imputation model BMI age 7 years. use midoc function checkModSpec applied bmi dataset check whether imputation model correctly specified, specifying formula imputation model using standard R syntax (formula), type imputation model (family) (note midoc currently supports either linear logistic regression models), name dataset (data). Since maternal education pregnancy size binary variables, need explore form relationship BMI age 7 years continuous exposure, maternal age. first assume linear relationship BMI age 7 years maternal age (note, default software implementations MI). assume interactions. results shown . suggest imputation model mis-specified. plot residuals versus fitted values model (automatically displayed evidence model mis-specification), suggests may quadratic relationship BMI age 7 years maternal age.  use midoc function checkModSpec , time specifying quadratic relationship BMI age 7 years maternal age. results suggest longer evidence model mis-specification. Note must make sure account non-linear relationship BMI age 7 years maternal age imputation models. example, imputation model pregnancy size need include BMI age 7 years, maternal education, quadratic form maternal age (induced conditioning BMI age 7 years). Although missing values pregnancy size dataset, can still explore specification need using checkModSpec follows (note suppressed plot case using plot = FALSE option): evidence model mis-specification. include quadratic form maternal age model pregnancy size, little evidence model mis-specification: Tips imputation model variable selection imputation model partially observed variable include: analysis model variables - check relationships partially observed variable predictors correctly specified imputation model e.g. using fractional polynomial selection auxiliary variables related missingness partially observed variable missing data , conditional analysis model variables Auxiliary variables related missing data missingness partially observed variable, conditional variables selected Steps 1 2 - large number variables, include predictive imputation model (using suitable variable selection method identify ) imputation model partially observed variable exclude: auxiliary variables related missingness partially observed variable missing data, conditional variables selected Steps 1, 2, 3 auxiliary variables colliders partially observed variable missingness","code":"checkModSpec(formula=\"bmi7~matage+mated+pregsize\", family=\"gaussian(identity)\",               data=bmi) Model mis-specification method: regression of model residuals on a  fractional polynomial of the fitted values   P-value: 0   A small p-value means the model may be mis-specified. Check the  specification of each relationship in your model. checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\", family=\"gaussian(identity)\",               data=bmi) Model mis-specification method: regression of model residuals on a  fractional polynomial of the fitted values   P-value: 1   A large p-value means there is little evidence of model mis-specification. checkModSpec(formula=\"pregsize~matage+bmi7+mated\", family=\"binomial(logit)\",              data=bmi, plot=FALSE) Model mis-specification method: Pregibon's link test   P-value: 0.03831304   A small p-value means the model may be mis-specified. Check the  specification of each relationship in your model. checkModSpec(formula=\"pregsize~matage+I(matage^2)+bmi7+mated\", family=\"binomial(logit)\",               data=bmi) Model mis-specification method: Pregibon's link test   P-value: 0.5553561   A large p-value means there is little evidence of model mis-specification."},{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"step-5-perform-mi-using-the-proposed-imputation-model","dir":"Articles","previous_headings":"","what":"Step 5 Perform MI using the proposed imputation model","title":"Multiple Imputation DOCtor (midoc)","text":"explored validity MI principle, using mDAG, specification imputation model, based observed data. now use midoc function proposeMI choose best options performing MI using mice package. first save chosen imputation model (.e. specifying quadratic relationship BMI age 7 years maternal age) mimod object (note suppressed checkModSpec output case using message = FALSE option). use , along dataset, construct call “mice” function. Note also save proposed “mice” call miprop object, used later. results shown . particular, note proposed “mice” call, default values number imputations, method, formulas, number iterations changed. Plots distributions imputed observed data, based sample five imputed datasets, suggest extreme values handled appropriately using proposed imputation method. Trace plots, showing mean standard deviation imputed values across iterations, also displayed. Note need adjust number iterations , dataset, one variable partially observed.  Note Given multiple partially observed variables, can specify list imputation models (one partially observed variable) proposeMI (although note Shiny app allows single imputation model specified). example, suppose pregnancy size also partially observed (assuming, simplicity, pregnancy size missing completely random). construct proposed “mice” call using proposeMI, follows: Returning example, assume adjustment required proposed “mice” call. use midoc function doMImice perform MI, specifying proposed “mice” call (miprop) seed “mice” call (seed) (results reproducible). also specify substantive model interest (substmod): regression BMI 7 years maternal age (fitting quadratic relationship) maternal education. optional step: specify substantive model, fitted automatically imputed dataset pooled results displayed (equivalent using “mice” functions pool). substantive model specified, imputation step performed.","code":"mimod_bmi7 <- checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",                        family=\"gaussian(identity)\", data=bmi,                       message=FALSE) miprop <- proposeMI(mimodobj=mimod_bmi7, data=bmi) Based on your proposed imputation model and dataset, your mice() call should be as follows:  mice(data =  bmi , # You may need to specify a subset of the columns in your dataset    m =  41 , # You should use at least this number of imputations based on the proportion of complete records in your dataset    method = c( 'norm' )  # Specify a method for each incomplete variable.  If displayed, the  box-and-whisker plots can be used to inform your choice of method(s):  for example, if the imputation model does not predict extreme values  appropriately, consider a different imputation model/method e.g. PMM.  Note the distribution of imputed and observed values is displayed for  numeric variables only. The distribution may differ if data are missing  at random. If you suspect data are missing not at random, the plots can  also inform your choice of sensitivity parameter.      formulas = formulas_list , # Note that you do not additionally need to  specify a 'predmatrix'    # The formulas_list specifies the conditional imputation models, as follows:    'bmi7 ~ matage + I(matage^2) + mated + pregsize'    maxit = 10 , # If you have more than one incomplete variable, you  should check this number of iterations is sufficient by inspecting the  trace plots, if displayed.  Consider increasing the number of  iterations if there is a trend that does not stabilise by the 10th  iteration. Note that iteration is not required when only one variable  is partially observed.      printFlag = FALSE , # Change to printFlag=TRUE to display the history  as imputation is performed    seed = NA) # It is good practice to choose a seed so your results are  reproducible mimod_bmi7 <- checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",                        family=\"gaussian(identity)\", data=bmi,                       message=FALSE) mimod_pregsize <- checkModSpec(formula=\"pregsize~bmi7+matage+I(matage^2)+mated\",                       family=\"binomial(logit)\", data=bmi,                       message=FALSE) proposeMI(mimodobj=list(mimod_bmi7, mimod_pregsize), data=bmi) doMImice(miprop, 123, substmod=\"lm(bmi7 ~ matage + I(matage^2) + mated)\") Given the substantive model: lm(bmi7 ~ matage + I(matage^2) + mated)    multiple imputation estimates are as follows:            term   estimate  std.error  statistic       df       p.value 1 (Intercept) 17.6607324 0.07126548 247.816079 233.1668 2.116834e-284 2      matage  1.1504545 0.05230345  21.995769 184.5081  1.863532e-53 3 I(matage^2)  0.8414975 0.03231752  26.038433 257.1270  4.754845e-74 4      mated1 -1.0026194 0.10787751  -9.294054 159.1101  1.094881e-16        2.5 %     97.5 % 1 17.5203258 17.8011389 2  1.0472648  1.2536442 3  0.7778567  0.9051382 4 -1.2156760 -0.7895629"},{"path":"https://elliecurnow.github.io/midoc/articles/midoc.html","id":"illustration-using-our-worked-example","dir":"Articles","previous_headings":"","what":"Illustration using our worked example","title":"Multiple Imputation DOCtor (midoc)","text":"Finally, illustrate choice analysis approach affects estimated association maternal age BMI age 7 years, adjusted maternal education level. compare CRA MI estimates. performing MI, used either pregnancy size birth weight auxiliary variable fitted either linear quadratic relationship BMI age 7 years maternal age imputation model. analysis approach, fitted substantive analysis model used . parameter estimates linear quadratic terms maternal age, 95% confidence intervals, shown table . Note , simulated data missingness, know “true” association .e. association missing data - shown “Full data” row table. note results displayed third row (“MI fitting quadratic relationship, using pregnancy size”) exactly generated . avoid repetition, shown code fitting models. table, can see CRA MI (fitting quadratic relationship BMI age 7 years maternal age imputation model) estimates unbiased linear quadratic terms maternal age. MI estimates biased fitting linear relationship imputation model, particularly quadratic term maternal age. MI estimates using collider, birth weight, auxiliary variable slightly biased slightly less precise estimates using pregnancy size auxiliary variable. collider bias relatively small association BMI age 7 years maternal age strong setting. Note collider bias relatively larger association weak 8. Parameter estimates maternal age","code":""},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-about-midoc","dir":"Articles","previous_headings":"","what":"About midoc","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"Missing data common issue health social research, often addressed multiple imputation (MI). MI flexible general approach, suite software packages. However, using MI practice can complex. Application MI involves multiple decisions rarely justified even documented, little guidance available. Multiple Imputation DOCtor (midoc) R package decision-making system incorporates expert, --date guidance help choose appropriate analysis method missing data. midoc guide analysis, examining hypothesised causal relationships observed data advise whether MI needed, perform . assume interested obtaining unbiased estimates regression coefficients - note bias necessarily concern interest prediction (.e. diagnostic/prognostic modelling). , demonstrate key features midoc using worked example. example, wish estimate association maternal age first pregnancy (exposure) child’s body mass index (BMI) age 7 years (outcome). simplicity, consider one confounder relationship maternal age BMI age 7 years, maternal education level. Note simulated data study included midoc package bmi dataset. dataset contains 1000 observations, realistic values variable, exaggerated relationships variables (highlight consequences choice analysis approach). Note interactive version midoc vignette: Multiple Imputation DOCtor (midoc). version, can apply features midoc using DAG data.","code":""},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-step-1-specify-the-analysis-and-missingness-models-using-a-directed-acyclic-graph","dir":"Articles","previous_headings":"","what":"Step 1 Specify the analysis and missingness models using a directed acyclic graph","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"First, construct causal diagram, directed acyclic graph (DAG) example, using syntax per dagitty package. start specifying relationships variables, assuming missing data. assume maternal age (matage) causes BMI age 7 years (bmi7), maternal education level (mated) causes maternal age BMI age 7 years. can express relationships using “dagitty” syntax, follows: Next, partially observed variable, specify variables related probability missing (“missingness”) adding relationships DAG. type DAG often referred “missingness” DAG (mDAG) 1, 2. first use midoc function descMissData identify variables dataset partially observed, specifying outcome (y), covariates, .e. independent variables, (covs), dataset (data), follows. see two missing data patterns: either variables observed, BMI age 7 years missing covariates observed. can list missing data patterns dataset using Shiny app, uploading dataset (CSV format) editing text box . Note upload file, default bmi dataset analysed. Returning worked example, use indicator variable “R” denote missingness BMI age 7 years (example, R=1 BMI age 7 years observed, 0 otherwise). specific example, R also indicates complete record (R=1 variables fully observed, 0 otherwise) variables fully observed. suppose R related maternal education level via socio-economic position (SEP), .e. SEP cause maternal education level R, neither BMI age 7 years maternal age causes R. suppose SEP missing (unmeasured) individuals dataset; remind us fact, name variable sep_unmeas. mDAG now follows (note follow convention using lower case names variables code, R becomes “r”, ): Note instead believe maternal education direct cause R, mDAG follows: now draw mDAG visually check relationships specified intended: Note used additional commands specify layout mDAG shown - although necessary using midoc, go dagitty website like find using “dagitty” draw mDAGs.  can draw DAG using Shiny app, editing text box . final check mDAG, use midoc function exploreDAG explore whether relationships dataset consistent proposed mDAG, specifying mDAG (mdag) dataset (data), follows. Based relationships fully observed variables maternal age, maternal education, missingness BMI age 7 years, can see little evidence inconsistency dataset proposed mDAG. particular, mDAG assumes maternal age (matage) unrelated missingness BMI age 7 years (r), given maternal education (mated); results suggest plausible. Note use observed data explore whether BMI age 7 years unrelated missingness - need missing values BMI age 7 years order . can explore whether relationships dataset consistent proposed mDAG using Shiny app, uploading dataset (CSV format) editing text box . Note upload file, default bmi dataset analysed. Tips specifying “missingness” DAG First specify DAG analysis model, missing data. may find introduction DAGs useful 3. Next add missingness indicator(s) DAG. multiple variables missing data, may want start including just complete records indicator DAG. Identify variables related missingness using: Subject-matter knowledge, example, prior research causes drop-study knowledge data collection process Data exploration, example, performing logistic regression missingness indicator analysis model variables - noting may exclude variables large proportion missing data avoid perfect prediction","code":"matage -> bmi7 mated -> matage mated -> bmi7 descMissData(y=\"bmi7\", covs=\"matage mated\", data=bmi) pattern bmi7 matage mated   n pct        1    1      1     1 592  59        2    0      1     1 408  41 matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas -> mated sep_unmeas -> r matage -> bmi7 mated -> matage mated -> bmi7 mated -> r exploreDAG(mdag=\"matage -> bmi7 mated -> matage mated -> bmi7             sep_unmeas -> mated sep_unmeas -> r\", data=bmi) The proposed directed acyclic graph (DAG) implies that the following  pairs of variables are independent, or conditionally independent.  'X  _||_ Y | Z' should be read as 'X is independent of Y conditional on Z'.  Note that variable names are abbreviated:   bmi7 _||_ r | sp_n bmi7 _||_ r | matd bmi7 _||_ sp_n | matd matg _||_ r | sp_n matg _||_ r | matd matg _||_ sp_n | matd matd _||_ r | sp_n  These (conditional) independence statements are explored below using  the canonical correlations approach for mixed data. See  ??dagitty::localTests for further details.    Results are shown for variables that are fully observed in the  specified dataset.  The null hypothesis is that the stated variables are (conditionally)  independent.                           estimate  p.value        2.5%      97.5% matage _||_ r | mated 0.02998323 0.343547 -0.03206946 0.09180567   Interpretation: A small p-value means the stated variables may not be  (conditionally) independent in the specified dataset: your data may not  be consistent with the proposed DAG.  A large p-value means there is  little evidence of inconsistency between your data and the proposed DAG.   Note that these results assume that relationships between variables are  linear. Consider exploring the specification of each relationship in  your model.  Also consider whether it is valid and possible to explore  relationships between partially observed variables using the observed  data, e.g. avoiding perfect prediction."},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-step-2-check-whether-complete-records-analysis-is-likely-to-be-a-valid-strategy","dir":"Articles","previous_headings":"","what":"Step 2 Check whether complete records analysis is likely to be a valid strategy","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"next step determine whether complete records analysis (CRA) valid strategy, using mDAG. Remember , general, CRA valid analysis model outcome unrelated complete records indicator, conditional analysis model covariates 4 (special cases, depending type analysis model estimand interest, rule can relaxed 5 - , consider general setting without making assumptions fitted model). Suppose decide estimate unadjusted association BMI age 7 years maternal age, without including confounder maternal education model. use midoc function checkCRA applied mDAG check whether CRA valid model, specifying outcome (y), covariates, .e. independent variables, (covs), complete records indicator (r_cra), mDAG (mdag), follows: can see CRA valid (can also tell inspecting DAG: open path bmi7 r via mated sep_unmeas condition matage). checkCRA suggests CRA valid included mated, mated sep_unmeas, analysis model. particular setting, sensible include mated analysis model since confounder relationship matage bmi7. settings, might want include variables required valid CRA model might change interpretation - case, need use different analysis strategy. Note sep_unmeas related bmi7 condition mated (though still related missingness bmi7), need included analysis model. add mated model re-run checkCRA, , see CRA now valid. Note outcome, BMI age 7 years, cause missingness, CRA always invalid, .e. variables add analysis model make CRA valid. See see results checkCRA case (note, code, added path bmi7 r specified mDAG). can check whether CRA valid DAG analysis model using Shiny app, editing text box .","code":"checkCRA(y=\"bmi7\", covs=\"matage\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7           sep_unmeas -> mated sep_unmeas -> r\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are not independent given  analysis model covariates. Hence, in general, complete records analysis  is not valid.    In special cases, depending on the type of analysis model and estimand  of interest, complete records analysis may still be valid. See, for  example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  for further details.   Consider using a different analysis model and/or strategy, e.g.  multiple imputation.   For example, the analysis model outcome and complete record indicator  are independent if, in addition to the specified covariates, the  following sets of variables are included as covariates in the analysis  model (note that this list is not necessarily exhaustive, particularly  if your DAG is complex):   { mated } { mated, sep_unmeas } checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7           sep_unmeas -> mated sep_unmeas -> r\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are independent given analysis  model covariates. Hence, complete records analysis is valid. checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7           sep_unmeas -> mated sep_unmeas -> r bmi7 -> r\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are not independent given  analysis model covariates. Hence, in general, complete records analysis  is not valid.    In special cases, depending on the type of analysis model and estimand  of interest, complete records analysis may still be valid. See, for  example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  for further details.   There are no other variables which could be added to the model to make  the analysis model outcome and complete record indicator conditionally  independent, without changing the estimand of interest.    Consider using a different strategy e.g. multiple imputation."},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-step-3-check-whether-multiple-imputation-is-likely-to-be-a-valid-strategy","dir":"Articles","previous_headings":"","what":"Step 3 Check whether multiple imputation is likely to be a valid strategy","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"Although CRA valid example, may also wish perform MI. Remember MI valid principle partially observed variable unrelated missingness, given imputation model predictors. Furthermore, include analysis model variables imputation model partially observed variable, form implied analysis model, analysis imputation models “compatible”. theory, given multiple partially observed variables, validity MI may imply different causes missingness missing data pattern. example, BMI age 7 years maternal education partially observed, MI valid missingness BMI age 7 years unrelated maternal education among individuals missing BMI age 7 years maternal education (given observed data), although missingness BMI age 7 years related maternal education among individuals observed maternal education. practice, recommend focusing common missing data patterns /variables missing data. Less common missing data patterns can often assumed missing completely random - unlikely change final conclusions assumption incorrect. example, single partially observed variable (BMI age 7 years), relatively simple check validity MI based mDAG. already verified (using checkCRA) BMI age 7 years unrelated missingness, given maternal age maternal education. Therefore, know MI valid use variables imputation model BMI age 7 years (analysis model imputation model exactly case). However, MI using just maternal age maternal education imputation model BMI age 7 years recover additional information compared CRA. Therefore, may wish include “auxiliary variables” imputation model BMI age 7 years (.e. variables predictive BMI age 7 years, required analysis model) improve precision MI estimate, compared CRA estimate. example, two variables used auxiliary variables: pregnancy size - singleton multiple birth - (pregsize) birth weight (bwt). inspect missing data patterns dataset , included auxiliary variables, using descMissData. can see auxiliary variables fully observed. assume pregnancy size cause BMI age 7 years, missingness, whereas assume birth weight related BMI 7 years (via pregnancy size) missingness (via SEP). now add variables mDAG. , shown updated mDAG.  also explore whether relationships dataset consistent updated mDAG using exploreDAG, follows. results suggest updated mDAG plausible. Note CRA still valid updated mDAG. can check using checkCRA : now use midoc function checkMI applied DAG check whether MI valid imputation model predictors BMI age 7 years include pregnancy size birth weight, well maternal age maternal education, specifying partially observed variable (dep), predictors (preds), missingness indicator partially observed variable (r_dep), mDAG (mdag). first consider imputation model including pregnancy size. results shown . suggest MI valid principle included pregnancy size well analysis model variables imputation model BMI age 7 years. next consider imputation model including birth weight. results shown . suggest MI valid included birth weight well analysis model variables imputation model BMI age 7 years (can also tell inspecting mDAG: since bwt shares common cause bmi7 r, “collider”, hence conditioning bwt opens path bmi7 r via bwt). Note theory, suggested checkMI results shown , MI valid added birth weight pregnancy size auxiliary variables imputation model (note SEP needed, conditional imputation model predictors). However, practice, strategy may still result biased estimates, due unmeasured confounding relationship BMI age 7 years birth weight. recommend including colliders partially observed variable missingness auxiliary variables 6. can check whether MI valid DAG imputation models (checking imputation model partially observed variable turn) using Shiny app, editing text box .","code":"descMissData(y=\"bmi7\", covs=\"matage mated pregsize bwt\",               data=bmi) pattern bmi7 matage mated pregsize bwt   n pct        1    1      1     1        1   1 592  59        2    0      1     1        1   1 408  41 exploreDAG(mdag=\"matage -> bmi7 mated -> matage mated -> bmi7              sep_unmeas -> mated  sep_unmeas-> r              pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\",             data=bmi) The proposed directed acyclic graph (DAG) implies that the following  pairs of variables are independent, or conditionally independent.  'X  _||_ Y | Z' should be read as 'X is independent of Y conditional on Z'.  Note that variable names are abbreviated:   bmi7 _||_ bwt | prgs, sp_n bmi7 _||_ bwt | matd, prgs bmi7 _||_ r | sp_n bmi7 _||_ r | matd bmi7 _||_ sp_n | matd bwt _||_ matg | matd bwt _||_ matg | sp_n bwt _||_ matd | sp_n bwt _||_ r | sp_n matg _||_ prgs matg _||_ r | sp_n matg _||_ r | matd matg _||_ sp_n | matd matd _||_ prgs matd _||_ r | sp_n prgs _||_ r prgs _||_ sp_n  These (conditional) independence statements are explored below using  the canonical correlations approach for mixed data. See  ??dagitty::localTests for further details.    Results are shown for variables that are fully observed in the  specified dataset.  The null hypothesis is that the stated variables are (conditionally)  independent.                             estimate   p.value        2.5%      97.5% bwt _||_ matage | mated 0.05018898 0.1127099 -0.01184095 0.11183410 matage _||_ pregsize    0.03029139 0.3386080 -0.03176134 0.09211150 matage _||_ r | mated   0.02998323 0.3435470 -0.03206946 0.09180567 mated _||_ pregsize     0.01594976 0.6144181 -0.04608889 0.07786585 pregsize _||_ r         0.01482015 0.6397174 -0.04721631 0.07674273   Interpretation: A small p-value means the stated variables may not be  (conditionally) independent in the specified dataset: your data may not  be consistent with the proposed DAG.  A large p-value means there is  little evidence of inconsistency between your data and the proposed DAG.   Note that these results assume that relationships between variables are  linear. Consider exploring the specification of each relationship in  your model.  Also consider whether it is valid and possible to explore  relationships between partially observed variables using the observed  data, e.g. avoiding perfect prediction. checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",          mdag=\"matage -> bmi7 mated -> matage mated -> bmi7           sep_unmeas -> mated sep_unmeas -> r           pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\") Based on the proposed directed acyclic graph (DAG), the analysis model  outcome and complete record indicator are independent given analysis  model covariates. Hence, complete records analysis is valid. checkMI(dep=\"bmi7\", preds=\"matage mated pregsize\", r_dep=\"r\",         mdag=\"matage -> bmi7 mated -> matage mated -> bmi7          sep_unmeas -> mated sep_unmeas -> r          pregsize -> bmi7 pregsize -> bwtsep_unmeas -> bwt\") Based on the proposed directed acyclic graph (DAG), the incomplete  variable and its missingness indicator are independent given imputation  model predictors. Hence, multiple imputation methods which assume data  are missing at random are valid in principle. checkMI(dep=\"bmi7\", preds=\"matage mated bwt\", r_dep=\"r\",         mdag=\"matage -> bmi7 mated -> matage mated -> bmi7          sep_unmeas -> mated sep_unmeas -> r          pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\") Based on the proposed directed acyclic graph (DAG), the incomplete  variable and its missingness indicator are not independent given  imputation model predictors. Hence, multiple imputation methods which  assume data are missing at random are not valid.    Consider using a different imputation model and/or strategy (e.g.  not-at-random fully conditional specification).   For example, the incomplete variable and its missingness indicator are  independent if, in addition to the specified predictors, the following  sets of variables are included as predictors in the imputation model  (note that this list is not necessarily exhaustive, particularly if  your DAG is complex):   { pregsize } { pregsize, sep_unmeas }"},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-step-4-check-that-all-relationships-are-correctly-specified","dir":"Articles","previous_headings":"","what":"Step 4 Check that all relationships are correctly specified","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"far, explored whether CRA MI valid principle using mDAG, without making assumptions form variables, relationships . However, MI give unbiased estimates, imputation models must compatible analysis model correctly specified: must contain variables required analysis model, must include relationships implied analysis model e.g. interactions, must specify form relationships correctly 7. Since CRA MI valid principle worked example, use complete records bmi dataset explore specification relationships BMI age 7 years predictors (analysis model variables, maternal age maternal education, plus auxiliary variable, pregnancy size) imputation model BMI age 7 years. use midoc function checkModSpec applied bmi dataset check whether imputation model correctly specified, specifying formula imputation model using standard R syntax (formula), type imputation model (family) (note midoc currently supports either linear logistic regression models), name dataset (data). Since maternal education pregnancy size binary variables, need explore form relationship BMI age 7 years continuous exposure, maternal age. first assume linear relationship BMI age 7 years maternal age (note, default software implementations MI). assume interactions. results shown . suggest imputation model mis-specified. plot residuals versus fitted values model (automatically displayed evidence model mis-specification), suggests may quadratic relationship BMI age 7 years maternal age.  use midoc function checkModSpec , time specifying quadratic relationship BMI age 7 years maternal age. results suggest longer evidence model mis-specification. Note must make sure account non-linear relationship BMI age 7 years maternal age imputation models. example, imputation model pregnancy size need include BMI age 7 years, maternal education, quadratic form maternal age (induced conditioning BMI age 7 years). Although missing values pregnancy size dataset, can still explore specification need using checkModSpec follows (note suppressed plot case using plot = FALSE option): evidence model mis-specification. include quadratic form maternal age model pregnancy size, little evidence model mis-specification: can explore whether relationships dataset consistent proposed model using Shiny app, uploading dataset (CSV format) editing text box . Note diagnostic plot displayed (.e. plot set FALSE). note upload file, default bmi dataset analysed. Tips imputation model variable selection imputation model partially observed variable include: analysis model variables - check relationships partially observed variable predictors correctly specified imputation model e.g. using fractional polynomial selection auxiliary variables related missingness partially observed variable missing data , conditional analysis model variables Auxiliary variables related missing data missingness partially observed variable, conditional variables selected Steps 1 2 - large number variables, include predictive imputation model (using suitable variable selection method identify ) imputation model partially observed variable exclude: auxiliary variables related missingness partially observed variable missing data, conditional variables selected Steps 1, 2, 3 auxiliary variables colliders partially observed variable missingness","code":"checkModSpec(formula=\"bmi7~matage+mated+pregsize\",               family=\"gaussian(identity)\",               data=bmi) Model mis-specification method: regression of model residuals on a  fractional polynomial of the fitted values   P-value: 0   A small p-value means the model may be mis-specified. Check the  specification of each relationship in your model. checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",               family=\"gaussian(identity)\",               data=bmi) Model mis-specification method: regression of model residuals on a  fractional polynomial of the fitted values   P-value: 1   A large p-value means there is little evidence of model mis-specification. checkModSpec(formula=\"pregsize~matage+bmi7+mated\",               family=\"binomial(logit)\",              data=bmi, plot=FALSE) Model mis-specification method: Pregibon's link test   P-value: 0.03831304   A small p-value means the model may be mis-specified. Check the  specification of each relationship in your model. checkModSpec(formula=\"pregsize~matage+I(matage^2)+bmi7+mated\",               family=\"binomial(logit)\",               data=bmi) Model mis-specification method: Pregibon's link test   P-value: 0.5553561   A large p-value means there is little evidence of model mis-specification."},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-step-5-perform-mi-using-the-proposed-imputation-model","dir":"Articles","previous_headings":"","what":"Step 5 Perform MI using the proposed imputation model","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"explored validity MI principle, using mDAG, specification imputation model, based observed data. now use midoc function proposeMI choose best options performing MI using mice package. first save chosen imputation model (.e. specifying quadratic relationship BMI age 7 years maternal age) mimod object (note suppressed checkModSpec output case using message = FALSE option). use , along dataset, construct call “mice” function. Note plotprompt = FALSE option proposeMI used suppress user prompts R Console displaying second plot - useful vignette, recommend using default value TRUE regular use proposeMI. Note also save proposed “mice” call miprop object, used later. results shown . particular, note proposed “mice” call, default values number imputations, method, formulas, number iterations changed. Plots distributions imputed observed data, based sample five imputed datasets, suggest extreme values handled appropriately using proposed imputation method. Trace plots, showing mean standard deviation imputed values across iterations, also displayed. Note need adjust number iterations , dataset, one variable partially observed.  can explore optimal “mice” options dataset, based specified imputation model, using Shiny app, uploading dataset (CSV format) editing text box . Note diagnostic plots displayed (.e. plot set FALSE). note upload file, default bmi dataset analysed. Note Given multiple partially observed variables, can specify list imputation models (one partially observed variable) proposeMI (although note Shiny app allows single imputation model specified). example, suppose pregnancy size also partially observed (assuming, simplicity, pregnancy size missing completely random). construct proposed “mice” call using proposeMI, follows: Returning example, assume adjustment required proposed “mice” call. use midoc function doMImice perform MI, specifying proposed “mice” call (miprop) seed “mice” call (seed) (results reproducible). also specify substantive model interest (substmod): regression BMI 7 years maternal age (fitting quadratic relationship) maternal education. optional step: specify substantive model, fitted automatically imputed dataset pooled results displayed (equivalent using “mice” functions pool). substantive model specified, imputation step performed. can perform multiple imputation using “mice” dataset, based specified imputation analysis models, using Shiny app, uploading dataset (CSV format) editing text box . Note upload file, default bmi dataset analysed.","code":"mimod <- checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",                        family=\"gaussian(identity)\",                        data=bmi,                       message=FALSE) miprop <- proposeMI(mimod, data=bmi, plotprompt=FALSE) Based on your proposed imputation model and dataset, your mice() call should be as follows:  mice(data =  bmi , # You may need to specify a subset of the columns in your dataset    m =  41 , # You should use at least this number of imputations based on the proportion of complete records in your dataset    method = c( 'norm' )  # Specify a method for each incomplete variable.  If displayed, the  box-and-whisker plots can be used to inform your choice of method(s):  for example, if the imputation model does not predict extreme values  appropriately, consider a different imputation model/method e.g. PMM.  Note the distribution of imputed and observed values is displayed for  numeric variables only. The distribution may differ if data are missing  at random. If you suspect data are missing not at random, the plots can  also inform your choice of sensitivity parameter.      formulas = formulas_list , # Note that you do not additionally need to  specify a 'predmatrix'    # The formulas_list specifies the conditional imputation models, as follows:    'bmi7 ~ matage + I(matage^2) + mated + pregsize'    maxit = 10 , # If you have more than one incomplete variable, you  should check this number of iterations is sufficient by inspecting the  trace plots, if displayed.  Consider increasing the number of  iterations if there is a trend that does not stabilise by the 10th  iteration. Note that iteration is not required when only one variable  is partially observed.      printFlag = FALSE , # Change to printFlag=TRUE to display the history  as imputation is performed    seed = NA) # It is good practice to choose a seed so your results are  reproducible mimod_bmi7 <- checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",                        family=\"gaussian(identity)\", data=bmi,                       message=FALSE) mimod_pregsize <- checkModSpec(formula=\"pregsize~bmi7+matage+I(matage^2)+mated\",                       family=\"binomial(logit)\", data=bmi,                       message=FALSE) proposeMI(mimodobj=list(mimod_bmi7, mimod_pregsize), data=bmi) doMImice(miprop, 123,           substmod=\"lm(bmi7 ~ matage + I(matage^2) + mated)\") Given the substantive model: lm(bmi7 ~ matage + I(matage^2) + mated)    multiple imputation estimates are as follows:            term   estimate  std.error  statistic       df       p.value 1 (Intercept) 17.6607324 0.07126548 247.816079 233.1668 2.116834e-284 2      matage  1.1504545 0.05230345  21.995769 184.5081  1.863532e-53 3 I(matage^2)  0.8414975 0.03231752  26.038433 257.1270  4.754845e-74 4      mated1 -1.0026194 0.10787751  -9.294054 159.1101  1.094881e-16        2.5 %     97.5 % 1 17.5203258 17.8011389 2  1.0472648  1.2536442 3  0.7778567  0.9051382 4 -1.2156760 -0.7895629"},{"path":"https://elliecurnow.github.io/midoc/articles/midocdemoShiny.html","id":"section-illustration-using-our-worked-example","dir":"Articles","previous_headings":"","what":"Illustration using our worked example","title":"Multiple Imputation DOCtor (midoc) Shiny version","text":"Finally, illustrate choice analysis approach affects estimated association maternal age BMI age 7 years, adjusted maternal education level. compare CRA MI estimates. performing MI, used either pregnancy size birth weight auxiliary variable fitted either linear quadratic relationship BMI age 7 years maternal age imputation model. analysis approach, fitted substantive analysis model used . parameter estimates linear quadratic terms maternal age, 95% confidence intervals, shown table . Note , simulated data missingness, know “true” association .e. association missing data - shown “Full data” row table. note results displayed third row (“MI fitting quadratic relationship, using pregnancy size”) exactly generated . avoid repetition, shown code fitting models. table, can see CRA MI (fitting quadratic relationship BMI age 7 years maternal age imputation model) estimates unbiased linear quadratic terms maternal age. MI estimates biased fitting linear relationship imputation model, particularly quadratic term maternal age. MI estimates using collider, birth weight, auxiliary variable slightly biased slightly less precise estimates using pregnancy size auxiliary variable. collider bias relatively small association BMI age 7 years maternal age strong setting. Note collider bias relatively larger association weak 8. Parameter estimates maternal age","code":""},{"path":"https://elliecurnow.github.io/midoc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Elinor Curnow. Author, maintainer.","code":""},{"path":"https://elliecurnow.github.io/midoc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Curnow E (2024). midoc: Decision-Making System Multiple Imputation. R package version 0.0.0.9000, https://elliecurnow.github.io/midoc/.","code":"@Manual{,   title = {midoc: A Decision-Making System For Multiple Imputation},   author = {Elinor Curnow},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://elliecurnow.github.io/midoc/}, }"},{"path":"https://elliecurnow.github.io/midoc/index.html","id":"midoc","dir":"","previous_headings":"","what":"A Decision-Making System For Multiple Imputation","title":"A Decision-Making System For Multiple Imputation","text":"Multiple Imputation DOCtor (midoc) R package decision-making system incorporates expert, --date guidance help choose appropriate analysis method missing data. midoc guide analysis, examining structure dataset advise whether multiple imputation (MI) needed, perform .","code":""},{"path":"https://elliecurnow.github.io/midoc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"A Decision-Making System For Multiple Imputation","text":"can install development version midoc GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"elliecurnow/midoc\")"},{"path":"https://elliecurnow.github.io/midoc/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 midoc authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/bmi.html","id":null,"dir":"Reference","previous_headings":"","what":"Child body mass index data — bmi","title":"Child body mass index data — bmi","text":"simulated dataset","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/bmi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Child body mass index data — bmi","text":"","code":"bmi"},{"path":[]},{"path":"https://elliecurnow.github.io/midoc/reference/bmi.html","id":"bmi","dir":"Reference","previous_headings":"","what":"bmi","title":"Child body mass index data — bmi","text":"data frame 1000 rows 6 columns: bmi7 Child's body mass index age 7 years matage Mother's age pregnancy, standardised relative mean age 30 mated Mother's educational level: post-16 years qualification pregsize Mother's pregnancy size: singleton twins bwt Child's birth weight kilograms r Missingness indicator: whether bmi7 reported ","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkCRA.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect complete records analysis model — checkCRA","title":"Inspect complete records analysis model — checkCRA","text":"Check complete records analysis valid proposed analysis model directed acyclic graph (DAG). Validity means complete records analysis allow unbiased estimation regression parameters, associations, causal effects.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkCRA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect complete records analysis model — checkCRA","text":"","code":"checkCRA(y, covs, r_cra, mdag)"},{"path":"https://elliecurnow.github.io/midoc/reference/checkCRA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect complete records analysis model — checkCRA","text":"y analysis model outcome, specified string covs analysis model covariate(s), specified string (space delimited) r_cra complete record indicator, specified string mdag DAG, specified string using dagitty syntax","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkCRA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect complete records analysis model — checkCRA","text":"message indicating whether complete records analysis valid proposed DAG analysis model outcome covariate(s)","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkCRA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inspect complete records analysis model — checkCRA","text":"DAG include observed unobserved variables related analysis model variables missingness, well required missingness indicators. general, complete records analysis valid analysis model outcome complete record indicator unrelated, conditional specified covariates. determined using proposed DAG checking whether analysis model complete record indicator 'd-separated', given covariates.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkCRA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inspect complete records analysis model — checkCRA","text":"","code":"checkCRA(y=\"bmi7\", covs=\"matage\", r_cra=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r\") #> Based on the proposed directed acyclic graph (DAG), the analysis model  #> outcome and complete record indicator are not independent given  #> analysis model covariates. Hence, in general, complete records analysis  #> is not valid.  #>   #> In special cases, depending on the type of analysis model and estimand  #> of interest, complete records analysis may still be valid. See, for  #> example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  #> for further details.  #>  #> Consider using a different analysis model and/or strategy, e.g.  #> multiple imputation.   #> For example, the analysis model outcome and complete record indicator  #> are independent if, in addition to the specified covariates, the  #> following sets of variables are included as covariates in the analysis  #> model (note that this list is not necessarily exhaustive, particularly  #> if your DAG is complex):  #>  #> { mated } #> { mated, sep_unmeas } checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r\") #> Based on the proposed directed acyclic graph (DAG), the analysis model  #> outcome and complete record indicator are independent given analysis  #> model covariates. Hence, complete records analysis is valid.  #>  checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r bmi7 -> r\") #> Based on the proposed directed acyclic graph (DAG), the analysis model  #> outcome and complete record indicator are not independent given  #> analysis model covariates. Hence, in general, complete records analysis  #> is not valid.  #>   #> In special cases, depending on the type of analysis model and estimand  #> of interest, complete records analysis may still be valid. See, for  #> example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  #> for further details.  #>  #> There are no other variables which could be added to the model to make  #> the analysis model outcome and complete record indicator conditionally  #> independent, without changing the estimand of interest.  #>   #> Consider using a different strategy e.g. multiple imputation.  #>    checkCRA(y=\"bmi7\", covs=\"matage mated\", r_cra=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r matage -> bmi3 mated -> bmi3 bmi3 -> bmi7   bmi3 -> r\") #> Based on the proposed directed acyclic graph (DAG), the analysis model  #> outcome and complete record indicator are not independent given  #> analysis model covariates. Hence, in general, complete records analysis  #> is not valid.  #>   #> In special cases, depending on the type of analysis model and estimand  #> of interest, complete records analysis may still be valid. See, for  #> example, Bartlett et al. (2015) (https://doi.org/10.1093/aje/kwv114)  #> for further details.  #>  #> There are no other variables which could be added to the model to make  #> the analysis model outcome and complete record indicator conditionally  #> independent, without changing the estimand of interest.  #>   #> Consider using a different strategy e.g. multiple imputation.  #>  #> Consider whether an estimand based on a different set of variables  #> could be of interest. For example, the analysis model outcome and  #> complete record indicator are independent given each of the following  #> sets of variables:  #>  #> { bmi3, mated } #> { bmi3, matage, mated } #> { bmi3, sep_unmeas } #> { bmi3, matage, sep_unmeas } #> { bmi3, mated, sep_unmeas } #> { bmi3, matage, mated, sep_unmeas }"},{"path":"https://elliecurnow.github.io/midoc/reference/checkMI.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect multiple imputation model — checkMI","title":"Inspect multiple imputation model — checkMI","text":"Check multiple imputation valid proposed imputation model directed acyclic graph (DAG). imputation model include analysis model variables predictors, well auxiliary variables. DAG include observed unobserved variables related analysis model variables missingness, well required missingness indicators.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkMI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect multiple imputation model — checkMI","text":"","code":"checkMI(dep, preds, r_dep, mdag)"},{"path":"https://elliecurnow.github.io/midoc/reference/checkMI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect multiple imputation model — checkMI","text":"dep partially observed variable imputed, specified string preds imputation model predictor(s), specified string (space delimited) r_dep partially observed variable's missingness indicator, specified string mdag DAG, specified string using dagitty syntax","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkMI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect multiple imputation model — checkMI","text":"message indicating whether multiple imputation valid proposed DAG imputation model","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkMI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inspect multiple imputation model — checkMI","text":"principle, multiple imputation valid partially observed variable unrelated missingness, given imputation model predictors.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkMI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inspect multiple imputation model — checkMI","text":"","code":"checkMI(dep=\"bmi7\", preds=\"matage mated pregsize\", r_dep=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\") #> Based on the proposed directed acyclic graph (DAG), the incomplete  #> variable and its missingness indicator are independent given imputation  #> model predictors. Hence, multiple imputation methods which assume data  #> are missing at random are valid in principle. checkMI(dep=\"bmi7\", preds=\"matage mated bwt\", r_dep=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\") #> Based on the proposed directed acyclic graph (DAG), the incomplete  #> variable and its missingness indicator are not independent given  #> imputation model predictors. Hence, multiple imputation methods which  #> assume data are missing at random are not valid.  #>   #> Consider using a different imputation model and/or strategy (e.g.  #> not-at-random fully conditional specification).  #>  #> For example, the incomplete variable and its missingness indicator are  #> independent if, in addition to the specified predictors, the following  #> sets of variables are included as predictors in the imputation model  #> (note that this list is not necessarily exhaustive, particularly if  #> your DAG is complex):  #>  #> { pregsize } #> { pregsize, sep_unmeas } checkMI(dep=\"matage\", preds=\"bmi7 mated\", r_dep=\"r\",   mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\") #> Based on the proposed directed acyclic graph (DAG), the incomplete  #> variable and its missingness indicator are independent given imputation  #> model predictors. Hence, multiple imputation methods which assume data  #> are missing at random are valid in principle."},{"path":"https://elliecurnow.github.io/midoc/reference/checkModSpec.html","id":null,"dir":"Reference","previous_headings":"","what":"Inspect parametric model specification — checkModSpec","title":"Inspect parametric model specification — checkModSpec","text":"Explore whether observed relationships specified dataset consistent proposed parametric model (may represent analysis imputation model).","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkModSpec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inspect parametric model specification — checkModSpec","text":"","code":"checkModSpec(formula, family, data, message = TRUE, plot = TRUE)"},{"path":"https://elliecurnow.github.io/midoc/reference/checkModSpec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inspect parametric model specification — checkModSpec","text":"formula symbolic description model fitted, dependent variable left ~ operator, covariates, separated + operators, right, specified string family description error distribution link function used model, specified string; family functions supported \"gaussian(identity)\" \"binomial(logit)\" data data frame containing variables stated formula message TRUE (default), displays message indicating whether relationships dependent variable covariates likely correctly specified ; use message = FALSE suppress message plot TRUE (default) evidence model mis-specification, displays plot can used explore functional form covariate specified model; use plot = FALSE disable plot","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkModSpec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inspect parametric model specification — checkModSpec","text":"object type 'miprop' (list containing specified formula, family, dataset name), plus, optionally, messages plots indicating whether relationships dependent variable covariates likely correctly specified ","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/checkModSpec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inspect parametric model specification — checkModSpec","text":"","code":"checkModSpec(formula=\"bmi7~matage+mated+pregsize\",   family=\"gaussian(identity)\", data=bmi) #> Model mis-specification method: regression of model residuals on a  #> fractional polynomial of the fitted values  #>  P-value: 0  #>  #> A small p-value means the model may be mis-specified. Check the  #> specification of each relationship in your model.  #>   checkModSpec(formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",   family=\"gaussian(identity)\", data=bmi) #> Model mis-specification method: regression of model residuals on a  #> fractional polynomial of the fitted values  #>  P-value: 1  #>  #> A large p-value means there is little evidence of model mis-specification.  #>   checkModSpec(formula=\"pregsize~bmi7+matage+mated\",   family=\"binomial(logit)\", data=bmi) #> Model mis-specification method: Pregibon's link test  #>  P-value: 0.03831304  #>  #> A small p-value means the model may be mis-specified. Check the  #> specification of each relationship in your model.  #>   checkModSpec(formula=\"pregsize~bmi7+matage+I(matage^2)+mated\",   family=\"binomial(logit)\", data=bmi) #> Model mis-specification method: Pregibon's link test  #>  P-value: 0.5553561  #>  #> A large p-value means there is little evidence of model mis-specification.  #>"},{"path":"https://elliecurnow.github.io/midoc/reference/descMissData.html","id":null,"dir":"Reference","previous_headings":"","what":"Lists missing data patterns in the specified dataset — descMissData","title":"Lists missing data patterns in the specified dataset — descMissData","text":"function summarises missing data patterns specified dataset. row output corresponds missing data pattern (1=observed, 0=missing). number percentage observations also displayed missing data pattern. first column indicates number missing data patterns. second column refers analysis model outcome ('y'), variables ('covs') displayed subsequent columns. Alternatively, 'y' can used display primary variable interest, e.g. 'y' refer exposure, variables listed 'covs'.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/descMissData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lists missing data patterns in the specified dataset — descMissData","text":"","code":"descMissData(y, covs, data, plot = FALSE)"},{"path":"https://elliecurnow.github.io/midoc/reference/descMissData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lists missing data patterns in the specified dataset — descMissData","text":"y analysis model outcome, specified string covs analysis model covariate(s), specified string (space delimited) data data frame containing specified analysis model outcome covariate(s) plot TRUE, displays plot using md.pattern visualise missing data patterns; use plot = FALSE (default) disable plot","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/descMissData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lists missing data patterns in the specified dataset — descMissData","text":"summary missing data patterns","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/descMissData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Lists missing data patterns in the specified dataset — descMissData","text":"","code":"descMissData(y=\"bmi7\", covs=\"matage mated\", data=bmi) #>  pattern bmi7 matage mated   n pct #>        1    1      1     1 592  59 #>        2    0      1     1 408  41 descMissData(y=\"bmi7\", covs=\"matage mated pregsize bwt\", data=bmi, plot=TRUE)  #>  pattern bmi7 matage mated pregsize bwt   n pct #>        1    1      1     1        1   1 592  59 #>        2    0      1     1        1   1 408  41"},{"path":"https://elliecurnow.github.io/midoc/reference/doMImice.html","id":null,"dir":"Reference","previous_headings":"","what":"Performs multiple imputation — doMImice","title":"Performs multiple imputation — doMImice","text":"Performs multiple imputation using mice, based 'mice' options dataset specified call  proposeMI.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/doMImice.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performs multiple imputation — doMImice","text":"","code":"doMImice(mipropobj, seed, substmod = \" \")"},{"path":"https://elliecurnow.github.io/midoc/reference/doMImice.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performs multiple imputation — doMImice","text":"mipropobj object type 'miprop', created call 'proposeMI' seed integer used set seed 'mice' call substmod Optionally, symbolic description substantive model fitted, specified string; supplied, model fitted imputed dataset results pooled","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/doMImice.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Performs multiple imputation — doMImice","text":"'mice' object type 'mids'","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/doMImice.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Performs multiple imputation — doMImice","text":"","code":"# First specify the imputation model as a 'mimod' object mimod_bmi7 <- checkModSpec(   formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",   family=\"gaussian(identity)\", data=bmi) #> Model mis-specification method: regression of model residuals on a  #> fractional polynomial of the fitted values  #>  P-value: 1  #>  #> A large p-value means there is little evidence of model mis-specification.  #>  # Save the proposed 'mice' options as a 'miprop' object miprop <- proposeMI(mimodobj=mimod_bmi7, data=bmi) #> Based on your proposed imputation model and dataset, your mice() call should be as follows:  #> mice(data =  bmi , # You may need to specify a subset of the columns in your dataset  #>   #> m =  41 , # You should use at least this number of imputations based on the proportion of complete records in your dataset  #>   #> method = c( 'norm' )  #> # Specify a method for each incomplete variable.  If displayed, the  #> box-and-whisker plots can be used to inform your choice of method(s):  #> for example, if the imputation model does not predict extreme values  #> appropriately, consider a different imputation model/method e.g. PMM.  #> Note the distribution of imputed and observed values is displayed for  #> numeric variables only. The distribution may differ if data are missing  #> at random. If you suspect data are missing not at random, the plots can  #> also inform your choice of sensitivity parameter.  #>   #>   #> formulas = formulas_list , # Note that you do not additionally need to  #> specify a 'predmatrix'  #>   #> # The formulas_list specifies the conditional imputation models, as follows:  #>   #> 'bmi7 ~ matage + I(matage^2) + mated + pregsize'  #>   #> maxit = 10 , # If you have more than one incomplete variable, you  #> should check this number of iterations is sufficient by inspecting the  #> trace plots, if displayed.  Consider increasing the number of  #> iterations if there is a trend that does not stabilise by the 10th  #> iteration. Note that iteration is not required when only one variable  #> is partially observed.  #>   #>   #> printFlag = FALSE , # Change to printFlag=TRUE to display the history  #> as imputation is performed  #>   #> seed = NA) # It is good practice to choose a seed so your results are  #> reproducible  #>    # Create the set of imputed datasets using the proposed 'mice' options imp <- doMImice(miprop,123) #> Now you have created your multiply imputed datasets, you can perform  #> your analysis and pool the results using the 'mice' functions 'with()'  #> and 'pool()'  #>   # Additionally, fit the substantive model to each imputed dataset and display # the pooled results doMImice(miprop, 123, substmod=\"lm(bmi7 ~ matage + I(matage^2) + mated)\") #> Given the substantive model: lm(bmi7 ~ matage + I(matage^2) + mated)  #>   #> multiple imputation estimates are as follows:  #>  #>          term   estimate  std.error  statistic       df       p.value #> 1 (Intercept) 17.6607324 0.07126548 247.816079 233.1668 2.116834e-284 #> 2      matage  1.1504545 0.05230345  21.995769 184.5081  1.863532e-53 #> 3 I(matage^2)  0.8414975 0.03231752  26.038433 257.1270  4.754845e-74 #> 4      mated1 -1.0026194 0.10787751  -9.294054 159.1101  1.094881e-16 #>        2.5 %     97.5 % #> 1 17.5203258 17.8011389 #> 2  1.0472648  1.2536442 #> 3  0.7778567  0.9051382 #> 4 -1.2156760 -0.7895629"},{"path":"https://elliecurnow.github.io/midoc/reference/exploreDAG.html","id":null,"dir":"Reference","previous_headings":"","what":"Compares data with proposed DAG — exploreDAG","title":"Compares data with proposed DAG — exploreDAG","text":"Explore whether relationships fully observed variables specified dataset consistent proposed directed acyclic graph (DAG) using localTests functionality.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/exploreDAG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compares data with proposed DAG — exploreDAG","text":"","code":"exploreDAG(mdag, data)"},{"path":"https://elliecurnow.github.io/midoc/reference/exploreDAG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compares data with proposed DAG — exploreDAG","text":"mdag DAG, specified string using dagitty syntax data data frame containing variables stated DAG. ordinal variables must integer-coded categorical variables must dummy-coded.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/exploreDAG.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compares data with proposed DAG — exploreDAG","text":"message indicating whether relationships fully observed variables specified dataset consistent proposed DAG","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/exploreDAG.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compares data with proposed DAG — exploreDAG","text":"","code":"exploreDAG(mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r\", data=bmi) #> The proposed directed acyclic graph (DAG) implies that the following  #> pairs of variables are independent, or conditionally independent.  'X  #> _||_ Y | Z' should be read as 'X is independent of Y conditional on Z'.  #> Note that variable names are abbreviated:  #>  #> bmi7 _||_ r | sp_n #> bmi7 _||_ r | matd #> bmi7 _||_ sp_n | matd #> matg _||_ r | sp_n #> matg _||_ r | matd #> matg _||_ sp_n | matd #> matd _||_ r | sp_n #>  #> These (conditional) independence statements are explored below using  #> the canonical correlations approach for mixed data. See  #> ??dagitty::localTests for further details.  #>   #> Results are shown for variables that are fully observed in the  #> specified dataset.  #> The null hypothesis is that the stated variables are (conditionally)  #> independent.  #>  #>                         estimate  p.value        2.5%      97.5% #> matage _||_ r | mated 0.02998323 0.343547 -0.03206946 0.09180567 #>  #>  Interpretation: A small p-value means the stated variables may not be  #> (conditionally) independent in the specified dataset: your data may not  #> be consistent with the proposed DAG.  A large p-value means there is  #> little evidence of inconsistency between your data and the proposed DAG.  #>  #> Note that these results assume that relationships between variables are  #> linear. Consider exploring the specification of each relationship in  #> your model.  Also consider whether it is valid and possible to explore  #> relationships between partially observed variables using the observed  #> data, e.g. avoiding perfect prediction.  #>  exploreDAG(mdag=\"matage -> bmi7 mated -> matage mated -> bmi7 sep_unmeas ->   mated sep_unmeas -> r pregsize -> bmi7 pregsize -> bwt sep_unmeas -> bwt\",   data=bmi) #> The proposed directed acyclic graph (DAG) implies that the following  #> pairs of variables are independent, or conditionally independent.  'X  #> _||_ Y | Z' should be read as 'X is independent of Y conditional on Z'.  #> Note that variable names are abbreviated:  #>  #> bmi7 _||_ bwt | prgs, sp_n #> bmi7 _||_ bwt | matd, prgs #> bmi7 _||_ r | sp_n #> bmi7 _||_ r | matd #> bmi7 _||_ sp_n | matd #> bwt _||_ matg | matd #> bwt _||_ matg | sp_n #> bwt _||_ matd | sp_n #> bwt _||_ r | sp_n #> matg _||_ prgs #> matg _||_ r | sp_n #> matg _||_ r | matd #> matg _||_ sp_n | matd #> matd _||_ prgs #> matd _||_ r | sp_n #> prgs _||_ r #> prgs _||_ sp_n #>  #> These (conditional) independence statements are explored below using  #> the canonical correlations approach for mixed data. See  #> ??dagitty::localTests for further details.  #>   #> Results are shown for variables that are fully observed in the  #> specified dataset.  #> The null hypothesis is that the stated variables are (conditionally)  #> independent.  #>  #>                           estimate   p.value        2.5%      97.5% #> bwt _||_ matage | mated 0.05018898 0.1127099 -0.01184095 0.11183410 #> matage _||_ pregsize    0.03029139 0.3386080 -0.03176134 0.09211150 #> matage _||_ r | mated   0.02998323 0.3435470 -0.03206946 0.09180567 #> mated _||_ pregsize     0.01594976 0.6144181 -0.04608889 0.07786585 #> pregsize _||_ r         0.01482015 0.6397174 -0.04721631 0.07674273 #>  #>  Interpretation: A small p-value means the stated variables may not be  #> (conditionally) independent in the specified dataset: your data may not  #> be consistent with the proposed DAG.  A large p-value means there is  #> little evidence of inconsistency between your data and the proposed DAG.  #>  #> Note that these results assume that relationships between variables are  #> linear. Consider exploring the specification of each relationship in  #> your model.  Also consider whether it is valid and possible to explore  #> relationships between partially observed variables using the observed  #> data, e.g. avoiding perfect prediction.  #>"},{"path":"https://elliecurnow.github.io/midoc/reference/fp.html","id":null,"dir":"Reference","previous_headings":"","what":"Fractional Polynomial Transformation as per mfp package: Ambler G, Benner A (2022). mfp: Multivariable Fractional Polynomials. R package version 1.5.2.2, https://CRAN.R-project.org/package=mfp. — fp","title":"Fractional Polynomial Transformation as per mfp package: Ambler G, Benner A (2022). mfp: Multivariable Fractional Polynomials. R package version 1.5.2.2, https://CRAN.R-project.org/package=mfp. — fp","text":"Fractional Polynomial Transformation per mfp package: Ambler G, Benner (2022). mfp: Multivariable Fractional Polynomials. R package version 1.5.2.2, https://CRAN.R-project.org/package=mfp.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/fp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fractional Polynomial Transformation as per mfp package: Ambler G, Benner A (2022). mfp: Multivariable Fractional Polynomials. R package version 1.5.2.2, https://CRAN.R-project.org/package=mfp. — fp","text":"","code":"fp(x, df = 4, select = NA, alpha = NA, scale = TRUE)"},{"path":"https://elliecurnow.github.io/midoc/reference/fp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fractional Polynomial Transformation as per mfp package: Ambler G, Benner A (2022). mfp: Multivariable Fractional Polynomials. R package version 1.5.2.2, https://CRAN.R-project.org/package=mfp. — fp","text":"x input variable df degrees freedom. df = 4 corresponds FP model maximum 2 permitted degrees freedom select sets variable selection level alpha sets FP selection level scale use pre-transformation scaling","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/midoc-package.html","id":null,"dir":"Reference","previous_headings":"","what":"midoc: A Decision-Making System For Multiple Imputation — midoc-package","title":"midoc: A Decision-Making System For Multiple Imputation — midoc-package","text":"midoc guide researchers analyses, examining structure dataset advise whether multiple imputation needed, perform . Missing data common issue health social research, often addressed multiple imputation (MI). MI flexible general approach, suite software packages. However, using MI practice can complex. Application MI involves multiple decisions rarely justified even documented, little guidance available. midoc decision-making system incorporates expert, --date guidance help researchers choose appropriate analysis method missing data.","code":""},{"path":[]},{"path":"https://elliecurnow.github.io/midoc/reference/midoc-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"midoc: A Decision-Making System For Multiple Imputation — midoc-package","text":"Maintainer: Elinor Curnow elinor.curnow@bristol.ac.uk (ORCID)","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/midocVignette.html","id":null,"dir":"Reference","previous_headings":"","what":"Run an interactive vignette for the midoc package — midocVignette","title":"Run an interactive vignette for the midoc package — midocVignette","text":"Runs interactive version midoc vignette: Multiple Imputation DOCtor (midoc). interactive version, can apply midoc functions shiny-package apps using DAG data.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/midocVignette.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run an interactive vignette for the midoc package — midocVignette","text":"","code":"midocVignette()"},{"path":"https://elliecurnow.github.io/midoc/reference/proposeMI.html","id":null,"dir":"Reference","previous_headings":"","what":"Suggests multiple imputation options — proposeMI","title":"Suggests multiple imputation options — proposeMI","text":"Suggests mice options perform multiple imputation, based proposed set imputation models (one partially observed variable) specified dataset.","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/proposeMI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suggests multiple imputation options — proposeMI","text":"","code":"proposeMI(mimodobj, data, message = TRUE, plot = TRUE, plotprompt = TRUE)"},{"path":"https://elliecurnow.github.io/midoc/reference/proposeMI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suggests multiple imputation options — proposeMI","text":"mimodobj object, list objects, type 'mimod', stands 'multiple imputation model', created call checkModSpec data data frame containing variables required imputation substantive analysis message TRUE (default), displays message describing proposed 'mice' options; use message=FALSE suppress message plot TRUE (default), displays diagnostic plots proposed 'mice' call; use plot=FALSE disable plots plotprompt TRUE (default), user prompted second plot displayed; use plotprompt=FALSE remove prompt","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/proposeMI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Suggests multiple imputation options — proposeMI","text":"object type 'miprop', can used run 'mice' using proposed options, plus, optionally, message diagnostic plots describing proposed 'mice' options","code":""},{"path":"https://elliecurnow.github.io/midoc/reference/proposeMI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Suggests multiple imputation options — proposeMI","text":"","code":"# First specify each imputation model as a 'mimod' object mimod_bmi7 <- checkModSpec( formula=\"bmi7~matage+I(matage^2)+mated+pregsize\",   family=\"gaussian(identity)\", data=bmi) #> Model mis-specification method: regression of model residuals on a  #> fractional polynomial of the fitted values  #>  P-value: 1  #>  #> A large p-value means there is little evidence of model mis-specification.  #>  mimod_pregsize <- checkModSpec( formula=\"pregsize~bmi7+matage+I(matage^2)+mated\",   family=\"binomial(logit)\", data=bmi) #> Model mis-specification method: Pregibon's link test  #>  P-value: 0.5553561  #>  #> A large p-value means there is little evidence of model mis-specification.  #>   # Display the proposed 'mice' options # Specifying a single imputation model proposeMI(mimodobj=mimod_bmi7, data=bmi) #> Based on your proposed imputation model and dataset, your mice() call should be as follows:  #> mice(data =  bmi , # You may need to specify a subset of the columns in your dataset  #>   #> m =  41 , # You should use at least this number of imputations based on the proportion of complete records in your dataset  #>   #> method = c( 'norm' )  #> # Specify a method for each incomplete variable.  If displayed, the  #> box-and-whisker plots can be used to inform your choice of method(s):  #> for example, if the imputation model does not predict extreme values  #> appropriately, consider a different imputation model/method e.g. PMM.  #> Note the distribution of imputed and observed values is displayed for  #> numeric variables only. The distribution may differ if data are missing  #> at random. If you suspect data are missing not at random, the plots can  #> also inform your choice of sensitivity parameter.  #>   #>   #> formulas = formulas_list , # Note that you do not additionally need to  #> specify a 'predmatrix'  #>   #> # The formulas_list specifies the conditional imputation models, as follows:  #>   #> 'bmi7 ~ matage + I(matage^2) + mated + pregsize'  #>   #> maxit = 10 , # If you have more than one incomplete variable, you  #> should check this number of iterations is sufficient by inspecting the  #> trace plots, if displayed.  Consider increasing the number of  #> iterations if there is a trend that does not stabilise by the 10th  #> iteration. Note that iteration is not required when only one variable  #> is partially observed.  #>   #>   #> printFlag = FALSE , # Change to printFlag=TRUE to display the history  #> as imputation is performed  #>   #> seed = NA) # It is good practice to choose a seed so your results are  #> reproducible  #>    # Specifying more than one imputation model proposeMI(mimodobj=list(mimod_bmi7,mimod_pregsize), data=bmi) #> Based on your proposed imputation model and dataset, your mice() call should be as follows:  #> mice(data =  bmi , # You may need to specify a subset of the columns in your dataset  #>   #> m =  41 , # You should use at least this number of imputations based on the proportion of complete records in your dataset  #>   #> method = c( 'norm', 'logreg' )  #> # Specify a method for each incomplete variable.  If displayed, the  #> box-and-whisker plots can be used to inform your choice of method(s):  #> for example, if the imputation model does not predict extreme values  #> appropriately, consider a different imputation model/method e.g. PMM.  #> Note the distribution of imputed and observed values is displayed for  #> numeric variables only. The distribution may differ if data are missing  #> at random. If you suspect data are missing not at random, the plots can  #> also inform your choice of sensitivity parameter.  #>   #>   #> formulas = formulas_list , # Note that you do not additionally need to  #> specify a 'predmatrix'  #>   #> # The formulas_list specifies the conditional imputation models, as follows:  #>   #> 'bmi7 ~ matage + I(matage^2) + mated + pregsize' #> 'pregsize ~ bmi7 + matage + I(matage^2) + mated'  #>  #>  maxit = 10 , # If you have more than one incomplete variable, you  #> should check this number of iterations is sufficient by inspecting the  #> trace plots, if displayed.  Consider increasing the number of  #> iterations if there is a trend that does not stabilise by the 10th  #> iteration. Note that iteration is not required when only one variable  #> is partially observed.  #>   #>   #> printFlag = FALSE , # Change to printFlag=TRUE to display the history  #> as imputation is performed  #>   #> seed = NA) # It is good practice to choose a seed so your results are  #> reproducible  #>"}]
